SearchDefinitions:
 moduleName: rainmaker-pgr-V2
 summary: PGR resolver for Rainmaker
 version: 1.0.0
 definitions:
 - name: serviceSearchWithDetails
   query: 
    baseQuery: select array_to_json(array_agg(row_to_json(serviceRequests))) from (select (select (select (row_to_json(services)) from ( select * from eg_pgr_service svc where svc.serviceRequestId=eg_pgr_service.serviceRequestId) services) as services),(select (select array_to_json(array_agg(row_to_json(actionHistory))) from ( select * from eg_pgr_action where businessKey=eg_pgr_service.serviceRequestId) actionHistory) as actionHistory) from eg_pgr_service $where limit 200) serviceRequests
    groupBy:    
    orderBy: 
   searchParams:
    condition: AND
    params:
    - name: tenantid
      isMandatory: true
      jsonPath: $.searchCriteria.tenantId
    - name: servicerequestid
      isMandatory: false
      jsonPath: $.searchCriteria.serviceRequestId
    - name: accountid
      isMandatory: false
      jsonPath: $.searchCriteria.accountId
    - name: status
      isMandatory: false
      jsonPath: $.searchCriteria.status
    - name: createdtime
      isMandatory: false
      operator: GE
      jsonPath: $.searchCriteria.startDate
    - name: createdtime
      isMandatory: false
      operator: LE
      jsonPath: $.searchCriteria.endDate
    - name: lastmodifiedtime
      isMandatory: false
      jsonPath: $.searchCriteria.lastUpdatedSince
    - name: serviceCode
      isMandatory: false
      jsonPath: $.searchCriteria.serviceCodes
    - name: phone
      isMandatory: false
      jsonPath: $.searchCriteria.phone


   output:
    jsonFormat: {"ResponseInfo": {}}
    outJsonPath: $.services
    responseInfoPath: $.ResponseInfo

